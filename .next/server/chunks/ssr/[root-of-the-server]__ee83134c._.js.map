{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/HP/Documents/Github/Hackathon_GL_2025/app/patients/dossier/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useRouter, useSearchParams } from \"next/navigation\";\r\nimport { FaArrowLeft, FaPrint, FaExclamationTriangle, FaCheckCircle } from \"react-icons/fa\";\r\n\r\ntype Patient = {\r\n  id: string;\r\n  name: string;\r\n  age: number;\r\n  sexe: string | null;\r\n  diagnosis: string;\r\n  poids: number | null;\r\n  taille: number | null;\r\n  traitement: string | null;\r\n  numSecu: string | null;\r\n  medecin: string | null;\r\n  createdAt: string;\r\n};\r\n\r\nexport default function FicheMedicalePatient() {\r\n  const { id } = useParams();\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const fromUpdate = searchParams.get('updated');\r\n  \r\n  const [patient, setPatient] = useState<Patient | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [showUpdateSuccess, setShowUpdateSuccess] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!id) return;\r\n\r\n    fetch(`/api/patients/${id}`)\r\n      .then(async (res) => {\r\n        if (!res.ok) throw new Error(`Erreur API: ${res.status}`);\r\n        const data = await res.json();\r\n        setPatient(data);\r\n        setLoading(false);\r\n        \r\n        if (fromUpdate === 'true') {\r\n          setShowUpdateSuccess(true);\r\n          setTimeout(() => {\r\n            window.print();\r\n          }, 1000);\r\n          setTimeout(() => {\r\n            setShowUpdateSuccess(false);\r\n          }, 5000);\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Erreur chargement fiche médicale:\", err);\r\n        setError(\"Impossible de charger les informations du patient\");\r\n        setLoading(false);\r\n      });\r\n  }, [id, fromUpdate]);\r\n\r\n  if (loading) return <div className=\"min-h-screen flex justify-center items-center text-xl text-gray-700\">Chargement...</div>;\r\n  if (error || !patient) return <div className=\"min-h-screen flex justify-center items-center text-red-600 text-xl\">{error || \"Patient introuvable.\"}</div>;\r\n\r\n  const isEtatCritique = patient.diagnosis?.toLowerCase().includes(\"critique\");\r\n  const dateCreation = new Date(patient.createdAt).toLocaleDateString('fr-FR');\r\n  const imc = patient.poids && patient.taille \r\n    ? (patient.poids / (patient.taille * patient.taille)).toFixed(1)\r\n    : null;\r\n\r\n  return (\r\n    <div className=\"min-h-screen p-6 print:p-0 bg-white text-black\">\r\n      {/* En-tête institutionnel */}\r\n      <header className=\"hidden print:flex justify-between items-center border-b-2 border-blue-800 pb-4 mb-6\">\r\n        <div className=\"text-left\">\r\n          <h1 className=\"text-2xl font-bold text-blue-900\">CENTRE HOSPITALIER UNIVERSITAIRE</h1>\r\n          <p className=\"text-gray-700\">Service de Médecine Générale</p>\r\n        </div>\r\n        <div className=\"text-right\">\r\n          <p className=\"font-bold\">UAC-IFRI-GL-2025</p>\r\n          <p>00229 Abomey-Calavi</p>\r\n          <p>Tél: +229 XX XX XX XX</p>\r\n        </div>\r\n      </header>\r\n\r\n      {showUpdateSuccess && (\r\n        <div className=\"fixed top-4 right-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded shadow-md flex items-center space-x-2 no-print z-50\">\r\n          <FaCheckCircle />\r\n          <span>Fiche mise à jour ! Impression en cours...</span>\r\n        </div>\r\n      )}\r\n      \r\n      <div className=\"max-w-4xl mx-auto print:max-w-full\">\r\n        {/* Barre d'actions (non imprimée) */}\r\n        <div className=\"flex justify-between mb-6 no-print\">\r\n          <button onClick={() => router.back()} className=\"flex items-center text-blue-800 hover:underline print:hidden\">\r\n            <FaArrowLeft className=\"mr-2\" /> Retour\r\n          </button>\r\n            <div className=\"flex gap-3\">\r\n            <button onClick={() => window.print()} className=\"bg-gray-700 text-white px-4 py-2 rounded flex items-center print:hidden\">\r\n              <FaPrint className=\"mr-2\" /> Imprimer\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Titre principal */}\r\n        <div className=\"text-center mb-8 border-b-2 border-blue-800 pb-4\">\r\n          <h1 className=\"text-3xl font-bold text-blue-900 mb-2\">FICHE MEDICALE PATIENT</h1>\r\n          <p className=\"text-sm text-gray-600\">N° Dossier: {patient.id}</p>\r\n        </div>\r\n\r\n        {/* Alerte état critique */}\r\n        {isEtatCritique && (\r\n          <div className=\"mb-6 p-3 bg-red-100 border-l-4 border-red-500 rounded flex items-center print:bg-red-50\">\r\n            <FaExclamationTriangle className=\"text-red-600 mr-2 text-xl\" />\r\n            <div>\r\n              <p className=\"font-bold text-red-700\">URGENCE MEDICALE</p>\r\n              <p className=\"text-sm\">Prise en charge prioritaire requise</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Section informations patient */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n          {/* Colonne gauche - Identité */}\r\n          <div className=\"border border-gray-300 rounded p-4\">\r\n            <h2 className=\"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200\">IDENTITÉ DU PATIENT</h2>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex\">\r\n                <span className=\"w-40 font-semibold\">Nom complet:</span>\r\n                <span className=\"border-b border-dotted border-gray-400 flex-1\">{patient.name}</span>\r\n              </div>\r\n              <div className=\"flex\">\r\n                <span className=\"w-40 font-semibold\">Date création:</span>\r\n                <span>{dateCreation}</span>\r\n              </div>\r\n              <div className=\"flex\">\r\n                <span className=\"w-40 font-semibold\">Âge/Sexe:</span>\r\n                <span>{patient.age} ans / {patient.sexe || \"NR\"}</span>\r\n              </div>\r\n              <div className=\"flex\">\r\n                <span className=\"w-40 font-semibold\">N° Sécurité Sociale:</span>\r\n                <span className=\"border-b border-dotted border-gray-400 flex-1\">{patient.numSecu || \"Non renseigné\"}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Colonne droite - Paramètres médicaux */}\r\n          <div className=\"border border-gray-300 rounded p-4\">\r\n            <h2 className=\"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200\">PARAMÈTRES MÉDICAUX</h2>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex\">\r\n                <span className=\"w-40 font-semibold\">Taille/Poids:</span>\r\n                <span>{patient.taille ? `${patient.taille} m` : \"NR\"} / {patient.poids ? `${patient.poids} kg` : \"NR\"}</span>\r\n              </div>\r\n              {imc && (\r\n                <div className=\"flex\">\r\n                  <span className=\"w-40 font-semibold\">IMC:</span>\r\n                  <span>{imc} kg/m²</span>\r\n                </div>\r\n              )}\r\n              <div className=\"flex\">\r\n                <span className=\"w-40 font-semibold\">Médecin traitant:</span>\r\n                <span>Dr {patient.medecin || \"Non désigné\"}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Section diagnostic */}\r\n        <div className=\"border border-gray-300 rounded p-4 mb-6\">\r\n          <h2 className=\"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200\">DIAGNOSTIC PRINCIPAL</h2>\r\n          <div className={`p-3 rounded ${isEtatCritique ? \"bg-red-50 border-l-4 border-red-500\" : \"bg-gray-50\"}`}>\r\n            <p className={isEtatCritique ? \"font-bold text-red-700\" : \"\"}>\r\n              {patient.diagnosis}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Section traitement */}\r\n        <div className=\"border border-gray-300 rounded p-4 mb-6\">\r\n          <h2 className=\"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200\">TRAITEMENT PRESCRIT</h2>\r\n          <div className=\"bg-gray-50 p-3 rounded\">\r\n            {patient.traitement ? (\r\n              <div className=\"whitespace-pre-line\">{patient.traitement}</div>\r\n            ) : (\r\n              <p className=\"italic text-gray-500\">Aucun traitement enregistré</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Section recommandations */}\r\n        <div className=\"border border-gray-300 rounded p-4 mb-6\">\r\n          <h2 className=\"text-xl font-bold text-blue-800 mb-4 pb-2 border-b border-blue-200\">RECOMMANDATIONS</h2>\r\n          <div className=\"space-y-2\">\r\n            {patient.traitement ? (\r\n              <>\r\n                <p>• Suivi médical régulier obligatoire</p>\r\n                <p>• Respect strict de la posologie prescrite</p>\r\n                <p>• Consultation immédiate en cas d aggravation</p>\r\n                {isEtatCritique && (\r\n                  <p className=\"font-bold text-red-700\">• Surveillance continue nécessaire</p>\r\n                )}\r\n              </>\r\n            ) : (\r\n              <p className=\"italic text-gray-500\">Aucune recommandation spécifique</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Pied de page institutionnel */}\r\n        <footer className=\"border-t-2 border-blue-800 pt-4 text-sm text-gray-700 print:mt-8\">\r\n          <div className=\"flex justify-between\">\r\n            <div>\r\n              <p>Éditée le: {new Date().toLocaleDateString('fr-FR')}</p>\r\n              <p>Par: Dr {patient.medecin || \"Médecin non spécifié\"}</p>\r\n            </div>\r\n            <div className=\"text-right\">\r\n              <p className=\"font-bold\">Document médical confidentiel</p>\r\n              <p>Signature et cachet du médecin:</p>\r\n              <div className=\"mt-8 border-t border-gray-400 w-48 ml-auto pt-2\">\r\n                <p className=\"text-center text-xs\">Cachet et signature</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </footer>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}