{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/macuser/Documents/GitHub/Hackathon_GL_2025/app/patients/dossier/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useParams, useRouter, useSearchParams } from \"next/navigation\";\nimport { FaArrowLeft, FaPrint, FaEdit, FaExclamationTriangle, FaCheckCircle } from \"react-icons/fa\";\n\ntype Patient = {\n  id: string;\n  name: string;\n  age: number;\n  sexe: string | null;\n  diagnosis: string;\n  poids: number | null;\n  taille: number | null;\n  traitement: string | null;\n  numSecu: string | null;\n  medecin: string | null;\n  createdAt: string;\n};\n\nexport default function FicheMedicalePatient() {\n  const { id } = useParams();\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const fromUpdate = searchParams.get('updated');\n  \n  const [patient, setPatient] = useState<Patient | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [showUpdateSuccess, setShowUpdateSuccess] = useState(false);\n\n  useEffect(() => {\n    if (!id) return;\n\n    fetch(`/api/patients/${id}`)\n      .then(async (res) => {\n        if (!res.ok) throw new Error(`Erreur API: ${res.status}`);\n        const data = await res.json();\n        setPatient(data);\n        setLoading(false);\n        \n        if (fromUpdate === 'true') {\n          setShowUpdateSuccess(true);\n          setTimeout(() => {\n            window.print();\n          }, 1000);\n          setTimeout(() => {\n            setShowUpdateSuccess(false);\n          }, 5000);\n        }\n      })\n      .catch((err) => {\n        console.error(\"Erreur chargement fiche médicale:\", err);\n        setError(\"Impossible de charger les informations du patient\");\n        setLoading(false);\n      });\n  }, [id, fromUpdate]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex justify-center items-center text-xl text-gray-700\">\n        Chargement de la fiche médicale...\n      </div>\n    );\n  }\n\n  if (error || !patient) {\n    return (\n      <div className=\"min-h-screen flex justify-center items-center text-red-600 text-xl\">\n        {error || \"Patient introuvable.\"}\n      </div>\n    );\n  }\n\n  const isEtatCritique = patient.diagnosis?.toLowerCase().includes(\"critique\");\n  const dateCreation = new Date(patient.createdAt).toLocaleDateString('fr-FR');\n  const imc = patient.poids && patient.taille \n    ? (patient.poids / (patient.taille * patient.taille)).toFixed(1)\n    : null;\n\n  return (\n    <div className=\"bg-gray-100 min-h-screen p-6 text-black\">\n      {showUpdateSuccess && (\n        <div className=\"fixed top-4 right-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded shadow-md flex items-center space-x-2 no-print z-50\">\n          <FaCheckCircle />\n          <span>Fiche médicale mise à jour avec succès ! Préparation de l impression...</span>\n        </div>\n      )}\n      \n      <div className=\"max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-md\">\n        <div className=\"flex justify-between items-center mb-6 no-print\">\n          <button\n            onClick={() => router.back()}\n            className=\"flex items-center text-indigo-600 hover:underline\"\n          >\n            <FaArrowLeft className=\"mr-2\" />\n            Retour à la liste\n          </button>\n          \n          <div className=\"flex space-x-3\">\n            <button\n              onClick={() => router.push(`/patients/${id}/completer`)}\n              className=\"bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition flex items-center\"\n            >\n              <FaEdit className=\"mr-2\" />\n              Compléter la fiche\n            </button>\n            \n            <button\n              onClick={() => window.print()}\n              className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition flex items-center\"\n            >\n              <FaPrint className=\"mr-2\" />\n              Imprimer\n            </button>\n          </div>\n        </div>\n\n        <div className=\"flex justify-between mb-4 text-sm\">\n          <div>\n            <p className=\"font-bold\">Dr {patient.medecin || \"Ratheil\"}</p>\n            <p>Médecin généraliste</p>\n          </div>\n          <div className=\"text-right\">\n            <p>UAC-IFRI-GL-2025</p>\n            <p>00229 Ab-Calavi</p>\n          </div>\n        </div>\n\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold mb-1\">FICHE MÉDICALE</h1>\n          <p className=\"text-center\">\n            __________________________<strong>CONFIDENTIEL</strong>__________________________\n          </p>\n        </div>\n\n        {isEtatCritique && (\n          <div className=\"mb-6 p-3 bg-red-100 border-l-4 border-red-500 rounded flex items-center\">\n            <FaExclamationTriangle className=\"text-red-600 mr-2 text-xl\" />\n            <span className=\"font-bold text-red-700\">ATTENTION : État critique</span>\n          </div>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n          <div className=\"bg-gray-50 p-4 rounded-lg shadow-sm\">\n            <h2 className=\"text-xl font-semibold text-indigo-700 mb-3 border-b pb-2\">\n              Informations personnelles\n            </h2>\n            \n            <div className=\"space-y-2 text-[16px]\">\n              <div className=\"grid grid-cols-[120px_1fr]\">\n                <span className=\"font-semibold\">Nom complet:</span>\n                <span>{patient.name}</span>\n              </div>\n              <div className=\"grid grid-cols-[120px_1fr]\">\n                <span className=\"font-semibold\">Âge:</span>\n                <span>{patient.age} ans</span>\n              </div>\n              {patient.sexe && (\n                <div className=\"grid grid-cols-[120px_1fr]\">\n                  <span className=\"font-semibold\">Sexe:</span>\n                  <span>{patient.sexe}</span>\n                </div>\n              )}\n              <div className=\"grid grid-cols-[120px_1fr]\">\n                <span className=\"font-semibold\">N° Sécu:</span>\n                <span>{patient.numSecu || \"Non renseigné\"}</span>\n              </div>\n              <div className=\"grid grid-cols-[120px_1fr]\">\n                <span className=\"font-semibold\">Date création:</span>\n                <span>{dateCreation}</span>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-gray-50 p-4 rounded-lg shadow-sm\">\n            <h2 className=\"text-xl font-semibold text-indigo-700 mb-3 border-b pb-2\">\n              Informations médicales\n            </h2>\n            \n            <div className=\"space-y-2 text-[16px]\">\n              <div className=\"grid grid-cols-[120px_1fr]\">\n                <span className=\"font-semibold\">Taille:</span>\n                <span>{patient.taille ? `${patient.taille} m` : \"Non renseigné\"}</span>\n              </div>\n              <div className=\"grid grid-cols-[120px_1fr]\">\n                <span className=\"font-semibold\">Poids:</span>\n                <span>{patient.poids ? `${patient.poids} kg` : \"Non renseigné\"}</span>\n              </div>\n              {imc && (\n                <div className=\"grid grid-cols-[120px_1fr]\">\n                  <span className=\"font-semibold\">IMC:</span>\n                  <span>{imc} kg/m²</span>\n                </div>\n              )}\n              <div className=\"grid grid-cols-[120px_1fr] items-start\">\n                <span className=\"font-semibold\">Diagnostic:</span>\n                <div>\n                  {isEtatCritique ? (\n                    <span className=\"text-red-600 font-medium flex items-center\">\n                      {patient.diagnosis}\n                      <FaExclamationTriangle className=\"ml-2\" />\n                    </span>\n                  ) : (\n                    patient.diagnosis\n                  )}\n                </div>\n              </div>\n              <div className=\"grid grid-cols-[120px_1fr] items-start\">\n                <span className=\"font-semibold\">Traitement:</span>\n                <span>{patient.traitement || \"Non renseigné\"}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-gray-50 p-4 rounded-lg shadow-sm mb-6\">\n          <h2 className=\"text-xl font-semibold text-indigo-700 mb-3 border-b pb-2\">\n            Recommandations\n          </h2>\n          \n          <div className=\"text-gray-700 py-2\">\n            {patient.traitement ? (\n              <div>\n                <p>Suivre scrupuleusement le traitement prescrit.</p>\n                <p>En cas d effets secondaires, contactez votre médecin immédiatement.</p>\n                {isEtatCritique && (\n                  <p className=\"font-bold text-red-600 mt-2\">\n                    Surveillance médicale stricte requise.\n                  </p>\n                )}\n              </div>\n            ) : (\n              <div className=\"flex items-center justify-center py-3 no-print\">\n                <p className=\"italic text-gray-500\">Aucune recommandation spécifique.</p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"border-t pt-4 flex justify-between text-sm text-gray-600\">\n          <div>\n            <p>ID Patient: {patient.id}</p>\n            <p>Date édition: {new Date().toLocaleDateString('fr-FR')}</p>\n          </div>\n          <div>\n            <p className=\"text-right\">Document confidentiel - Propriété médicale</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}