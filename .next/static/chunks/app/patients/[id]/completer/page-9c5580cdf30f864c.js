(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[345],{27258:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(95155),a=r(12115),n=r(35695),l=r(29911);function i(){let{id:e}=(0,n.useParams)(),t=(0,n.useRouter)(),[r,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(!1),[u,x]=(0,a.useState)(null),[b,p]=(0,a.useState)({});(0,a.useEffect)(()=>{e&&fetch("/api/patients/".concat(e)).then(async e=>{if(!e.ok)throw Error("Erreur API: ".concat(e.status));i(await e.json()),c(!1)}).catch(e=>{console.error("Erreur chargement patient:",e),x("Impossible de charger les informations du patient"),c(!1)})},[e]);let h=e=>{let{name:t,value:s,type:a}=e.target;if(!r)return;let n=s;"number"===a&&(n=s?parseFloat(s):null),i({...r,[t]:n}),b[t]&&p({...b,[t]:""})},g=()=>{let e={};return(null==r?void 0:r.poids)&&r.poids<=0&&(e.poids="Le poids doit \xeatre sup\xe9rieur \xe0 0"),(null==r?void 0:r.taille)&&r.taille<=0&&(e.taille="La taille doit \xeatre sup\xe9rieure \xe0 0"),(null==r?void 0:r.numSecu)&&!/^\d{13,15}$/.test(r.numSecu)&&(e.numSecu="Le num\xe9ro de s\xe9curit\xe9 sociale doit contenir entre 13 et 15 chiffres"),p(e),0===Object.keys(e).length},f=async s=>{if((s.preventDefault(),r&&e)&&g()){m(!0);try{let s=await fetch("/api/patients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw Error("Erreur lors de la sauvegarde: ".concat(s.status));t.push("/patients/dossier/".concat(e))}catch(e){console.error("Erreur lors de la sauvegarde:",e),x("Erreur lors de la sauvegarde des informations")}finally{m(!1)}}};return o?(0,s.jsx)("div",{className:"min-h-screen flex justify-center items-center text-xl text-gray-700",children:"Chargement des informations..."}):u||!r?(0,s.jsxs)("div",{className:"min-h-screen flex flex-col justify-center items-center text-red-600",children:[(0,s.jsx)(l.TNq,{className:"text-4xl mb-4"}),(0,s.jsx)("h2",{className:"text-xl",children:u||"Patient introuvable."}),(0,s.jsx)("button",{onClick:()=>t.back(),className:"mt-4 text-indigo-600 hover:underline",children:"Retour"})]}):(0,s.jsx)("div",{className:"bg-gray-100 min-h-screen p-6 text-black",children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto bg-white p-8 rounded-lg shadow-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("button",{onClick:()=>t.back(),className:"flex items-center text-indigo-600 hover:underline",children:[(0,s.jsx)(l.QVr,{className:"mr-2"}),"Retour"]}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-center text-indigo-700",children:"Compl\xe9ter la fiche m\xe9dicale"})]}),(0,s.jsxs)("form",{onSubmit:f,children:[(0,s.jsxs)("div",{className:"mb-6 bg-gray-50 p-4 rounded-md",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-indigo-700 mb-3",children:"Informations de base"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-700 font-medium mb-1",children:"Nom complet"}),(0,s.jsx)("input",{type:"text",value:r.name,className:"w-full p-2 border border-gray-300 rounded bg-gray-100 text-gray-700",disabled:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-700 font-medium mb-1",children:"\xc2ge"}),(0,s.jsx)("input",{type:"number",value:r.age,className:"w-full p-2 border border-gray-300 rounded bg-gray-100 text-gray-700",disabled:!0})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-gray-700 font-medium mb-1",children:"Diagnostic"}),(0,s.jsx)("input",{type:"text",value:r.diagnosis,className:"w-full p-2 border border-gray-300 rounded bg-gray-100 text-gray-700",disabled:!0})]})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-indigo-700 mb-3",children:"Informations m\xe9dicales compl\xe9mentaires"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-700 font-medium mb-1",children:["Poids (kg) ",(0,s.jsx)("span",{className:"text-gray-500 text-sm",children:"(optionnel)"})]}),(0,s.jsx)("input",{type:"number",name:"poids",value:r.poids||"",onChange:h,step:"0.1",placeholder:"Ex: 70.5",className:"w-full p-2 border rounded ".concat(b.poids?"border-red-500":"border-gray-300")}),b.poids&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.poids})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-gray-700 font-medium mb-1",children:["Taille (m) ",(0,s.jsx)("span",{className:"text-gray-500 text-sm",children:"(optionnel)"})]}),(0,s.jsx)("input",{type:"number",name:"taille",value:r.taille||"",onChange:h,step:"0.01",placeholder:"Ex: 1.75",className:"w-full p-2 border rounded ".concat(b.taille?"border-red-500":"border-gray-300")}),b.taille&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.taille})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{className:"block text-gray-700 font-medium mb-1",children:["Traitement en cours ",(0,s.jsx)("span",{className:"text-gray-500 text-sm",children:"(optionnel)"})]}),(0,s.jsx)("textarea",{name:"traitement",value:r.traitement||"",onChange:h,rows:3,placeholder:"Entrez les d\xe9tails du traitement",className:"w-full p-2 border border-gray-300 rounded"})]})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-indigo-700 mb-3",children:"Informations administratives"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{className:"block text-gray-700 font-medium mb-1",children:["Num\xe9ro de s\xe9curit\xe9 sociale ",(0,s.jsx)("span",{className:"text-gray-500 text-sm",children:"(optionnel)"})]}),(0,s.jsx)("input",{type:"text",name:"numSecu",value:r.numSecu||"",onChange:h,placeholder:"Ex: 1234567890123",className:"w-full p-2 border rounded ".concat(b.numSecu?"border-red-500":"border-gray-300")}),b.numSecu&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-1",children:b.numSecu})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{className:"block text-gray-700 font-medium mb-1",children:["M\xe9decin traitant ",(0,s.jsx)("span",{className:"text-gray-500 text-sm",children:"(optionnel)"})]}),(0,s.jsx)("input",{type:"text",name:"medecin",value:r.medecin||"",onChange:h,placeholder:"Ex: Dr. Martin",className:"w-full p-2 border border-gray-300 rounded"})]})]})]}),u&&(0,s.jsx)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:u}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 mt-8",children:[(0,s.jsx)("button",{type:"button",onClick:()=>t.back(),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition",children:"Annuler"}),(0,s.jsxs)("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition flex items-center ".concat(d?"opacity-75 cursor-not-allowed":""),children:[(0,s.jsx)(l.dIn,{className:"mr-2"}),d?"Enregistrement...":"Enregistrer et voir la fiche"]})]})]})]})})}},35695:(e,t,r)=>{"use strict";var s=r(18999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},74436:(e,t,r)=>{"use strict";r.d(t,{k5:()=>d});var s=r(12115),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=s.createContext&&s.createContext(a),l=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var s,a,n;s=e,a=t,n=r[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in s?Object.defineProperty(s,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[a]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>s.createElement(m,i({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>s.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function m(e){var t=t=>{var r,{attr:a,size:n,title:o}=e,d=function(e,t){if(null==e)return{};var r,s,a=function(e,t){if(null==e)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,l),m=n||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),s.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),o&&s.createElement("title",null,o),e.children)};return void 0!==n?s.createElement(n.Consumer,null,e=>t(e)):t(a)}},95991:(e,t,r)=>{Promise.resolve().then(r.bind(r,27258))}},e=>{var t=t=>e(e.s=t);e.O(0,[711,441,684,358],()=>t(95991)),_N_E=e.O()}]);